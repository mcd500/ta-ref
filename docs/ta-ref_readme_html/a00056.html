<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TA-REF: Tutorials of using GP API&#39;s in TEE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TA-REF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('a00056.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Tutorials of using GP API's in TEE </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Following are the set of AIST supported GP API's that can be used when writing your own TA is shown below.</p>
<h1><a class="anchor" id="autotoc_md22"></a>
Time Functions</h1>
<p >ree_time_get() - Retrieves the current REE system time.</p>
<p >Retrieves the current time as seen from the point of view of the REE which typically runs on Linux/Android or Windows with gettimeofday(). It is not safe to use the value of TEE_GetREETime() in TEE for security sensitive purposes but it is a good way to check what the apps on REE see the current time is.</p>
<dl class="section return"><dt>Returns</dt><dd>returns time value from OS running on REE</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">struct </span>timeval ree_time_get(void)</div>
<div class="line">{</div>
<div class="line">    TEE_Time time;</div>
<div class="line">    <span class="keyword">struct </span>timeval tv;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* REE time */</span></div>
<div class="line">    TEE_GetREETime(&amp;time);</div>
<div class="line">    tee_printf (<span class="stringliteral">&quot;@GP REE time %u sec %u millis\n&quot;</span>, time.seconds, time.millis);</div>
<div class="line">   </div>
<div class="line">    tv.tv_sec = time.seconds, tv.tv_usec = time.millis * 1000;</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">return</span> tv;</div>
<div class="line">}</div>
</div><!-- fragment --><p >tee_time_get() - Retrieves the current secure system time for the usage in TEE.</p>
<p >The TEE_GetSystemTime() returns the time value which is not able to be changed by User Applications on the REE side, but returns a tamper safe time value which normally requires hardware implementation with a separate RTC chip in the area where OS on REE can not access it and backed up with shield battery. The secure system is for security sensitive operations, such as checking expiration date of certificates and keys.</p>
<dl class="section return"><dt>Returns</dt><dd>returns time value for the usage in TEE</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">struct </span>timeval tee_time_get(void)</div>
<div class="line">{</div>
<div class="line">    TEE_Time time;</div>
<div class="line">    <span class="keyword">struct </span>timeval tv;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* System time */</span></div>
<div class="line">    TEE_GetSystemTime(&amp;time);</div>
<div class="line">    tee_printf (<span class="stringliteral">&quot;@GP Secure time %u sec %u millis\n&quot;</span>, time.seconds, time.millis);</div>
<div class="line">   </div>
<div class="line">    tv.tv_sec = time.seconds, tv.tv_usec = time.millis * 1000;</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">return</span> tv;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md23"></a>
Random Functions</h1>
<p >tee_random_get() - Generates the random value for secure operation in TEE.</p>
<p >It returns the closest value to the true random generator but the quality of the randomness depends on the hardware implementation. Quality of the random value is very important for having a good security level on many cryptographic algorithms used inside TEE. It is recommended to have equivalent level of SP 800-90B and FIPS 140-3.</p>
<dl class="section return"><dt>Returns</dt><dd>returns random value</dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> tee_random_get(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> rbuf[16];</div>
<div class="line">   </div>
<div class="line">    TEE_GenerateRandom(rbuf, <span class="keyword">sizeof</span>(rbuf));</div>
<div class="line">   </div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;random: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <span class="keyword">sizeof</span>(rbuf); i++) {</div>
<div class="line">        tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, rbuf[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24"></a>
Hash Functions</h1>
<p ><b>Generate message digest</b></p>
<p >message_digest_gen() - Example program to show how to use hash functions with ta-ref API.</p>
<p >Calculate hash value of a data in SHA256 and store it. Check the return value of each API call on real product development.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> message_digest_gen(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Data to take hash value as a example */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    <span class="keywordtype">size_t</span> hashlen = SHA_LENGTH;</div>
<div class="line">    uint8_t hash[SHA_LENGTH];</div>
<div class="line">    uint8_t *pdata = data;</div>
<div class="line">   </div>
<div class="line">    TEE_OperationHandle handle;</div>
<div class="line">    TEE_Result rv;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalant of sha3_init() in sha3.c or SHA256_Init() in openssl  */</span></div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_SHA256, TEE_MODE_DIGEST, SHA_LENGTH);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalant of sha3_update() in sha3.c or SHA256_Update() in openssl.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * It passes only a chunk of data each time.</span></div>
<div class="line"><span class="comment">     * Typically it is used with moving to the next pointer in a for loop to</span></div>
<div class="line"><span class="comment">     * handle large data until the last chunk. Calculating hash value in</span></div>
<div class="line"><span class="comment">     * iteration makes it possible to handle large data, such as 4GB which is</span></div>
<div class="line"><span class="comment">     * not able to have entire data inside TEE memory size and/or only</span></div>
<div class="line"><span class="comment">     * partial data arrives through the Internet in streaming fashion. */</span></div>
<div class="line">    TEE_DigestUpdate(handle, pdata, CHUNK_SIZE);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Used combined with the TEE_DigestUpdate.</span></div>
<div class="line"><span class="comment">     * When the data is larger, move to next pointer of chunk in the data </span></div>
<div class="line"><span class="comment">     * for every iteration */</span></div>
<div class="line">    pdata += CHUNK_SIZE;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalant of sha3_final() in sha3.c or SHA256_Final() in openssl.</span></div>
<div class="line"><span class="comment">     * This is the last chunk */</span></div>
<div class="line">    TEE_DigestDoFinal(handle, pdata, DATA_SIZE - CHUNK_SIZE, hash, &amp;hashlen);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Closing TEE handle */</span></div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* The hash value is ready, dump hashed data */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;hash: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hashlen; i++) {</div>
<div class="line">        tee_printf (<span class="stringliteral">&quot;%02x &quot;</span>, hash[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Save the hash value to secure storge */</span></div>
<div class="line">    secure_storage_write(hash, hashlen, <span class="stringliteral">&quot;hash_value&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p ><b>Verify the generated message disgest</b></p>
<p >message_digest_check() - Example program to show how to use hash functions with ta-ref API.</p>
<p >Checking the hash value is the easiest way to confirm the integrity of the data. Calculate hash value of a data and compare it with the saved hash value to verify whether the data is the same as the previous data. Check the return value of each API call on real product development.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on data match, others if not</dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> message_digest_check(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Data to compare the hash value with previous data */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    <span class="keywordtype">size_t</span> hashlen = SHA_LENGTH;</div>
<div class="line">    uint8_t hash[SHA_LENGTH];</div>
<div class="line">    uint8_t saved_hash[SHA_LENGTH];</div>
<div class="line">    uint8_t *pdata = data;</div>
<div class="line">   </div>
<div class="line">    TEE_OperationHandle handle;</div>
<div class="line">    TEE_Result rv;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Repeating the same as in message_digest_gen() until have the hash value */</span></div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_SHA256, TEE_MODE_DIGEST, SHA_LENGTH);</div>
<div class="line">    TEE_DigestUpdate(handle, data, CHUNK_SIZE);</div>
<div class="line">    pdata += CHUNK_SIZE;</div>
<div class="line">    TEE_DigestDoFinal(handle, pdata, DATA_SIZE - CHUNK_SIZE, hash, &amp;hashlen);</div>
<div class="line">   </div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* The hash value is ready, dump hashed data */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;hash: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hashlen; i++) {</div>
<div class="line">        tee_printf (<span class="stringliteral">&quot;%02x &quot;</span>, hash[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Check if the data is the same with the data in message_digest_gen() </span></div>
<div class="line"><span class="comment">     * to check the data integrity */</span></div>
<div class="line">    secure_storage_read(saved_hash, &amp;hashlen, <span class="stringliteral">&quot;hash_value&quot;</span>);</div>
<div class="line">    ret = memcmp(saved_hash, hash, hashlen);</div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        tee_printf(<span class="stringliteral">&quot;hash: matched!\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* returns 0 on success */</span></div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md25"></a>
Symmetric Crypto AES-GCM Functions</h1>
<p ><b>Symmetric Key Encryption</b></p>
<p >Example program to show how to use AES 256 GCM functions with ta-ref API.</p>
<p >Generate a key and encypt a data and stores it. Check the return value of each API call on real product development.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> symmetric_key_enc(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Data to encrypt as a example */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div>
<div class="line">        0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,</div>
<div class="line">        0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    uint8_t out[ENCDATA_MAX];</div>
<div class="line">    <span class="keywordtype">size_t</span>  outlen = ENCDATA_MAX;</div>
<div class="line">    uint8_t iv[TAG_LEN];</div>
<div class="line">    uint8_t tag[TAG_LEN];</div>
<div class="line">    <span class="keywordtype">size_t</span>  taglen = TAG_LEN_BITS;</div>
<div class="line">    uint8_t *pdata = data;</div>
<div class="line">    <span class="keywordtype">size_t</span>  keylen = 256;</div>
<div class="line">   </div>
<div class="line">    TEE_OperationHandle handle;</div>
<div class="line">    TEE_Result rv;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Generating Key with AES 256 GSM */</span></div>
<div class="line">    TEE_AllocateTransientObject(TEE_TYPE_AES, 256, &amp;key);</div>
<div class="line">    TEE_GenerateKey(key, 256, NULL, 0);</div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_AES_GCM, TEE_MODE_ENCRYPT, 256);</div>
<div class="line">    TEE_SetOperationKey(handle, key);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">// tee_printf(&quot;key: &quot;);</span></div>
<div class="line">    <span class="comment">// for (int i = 0; i &lt; 256 / 8; i++) {</span></div>
<div class="line">    <span class="comment">//   tee_printf (&quot;%02x&quot;, key[i]);</span></div>
<div class="line">    <span class="comment">// }</span></div>
<div class="line">    <span class="comment">// tee_printf(&quot;\n&quot;);</span></div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Prepare IV */</span></div>
<div class="line">    TEE_GenerateRandom(iv, <span class="keyword">sizeof</span>(iv));</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Start encrypting test data.</span></div>
<div class="line"><span class="comment">     * Equivalant of EVP_EncryptInit_ex() in openssl  */</span></div>
<div class="line">    TEE_AEInit(handle, iv, <span class="keyword">sizeof</span>(iv), TAG_LEN_BITS, 0, 0);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalant of EVP_EncryptUpdate() in openssl.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * It passes only a chunk of data each time.</span></div>
<div class="line"><span class="comment">     * Typically it is used with moving to the next pointer in a for loop to</span></div>
<div class="line"><span class="comment">     * handle large data until the last chunk. Encrypting in</span></div>
<div class="line"><span class="comment">     * iteration makes it possible to handle large data, such as 4GB which is</span></div>
<div class="line"><span class="comment">     * not able to have entire data inside TEE memory size and/or only</span></div>
<div class="line"><span class="comment">     * partial data arrives through the Internet in streaming fashion. */</span></div>
<div class="line">    TEE_AEUpdateAAD(handle, pdata, CHUNK_SIZE);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Used combined with the TEE_DigestUpdate.</span></div>
<div class="line"><span class="comment">     * When the data is larger, move to next pointer of chunk in the data </span></div>
<div class="line"><span class="comment">     * for every iteration */</span></div>
<div class="line">    pdata += CHUNK_SIZE;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalent in openssl is EVP_EncryptFinal() */</span> </div>
<div class="line">    TEE_AEEncryptFinal(handle, pdata, DATA_SIZE - CHUNK_SIZE, out, &amp;outlen, tag, &amp;taglen);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Closing TEE handle */</span></div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Dump encrypted data and tag */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Encrypted Data: size:%d &quot;</span>, outlen);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; outlen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, out[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;tag: size: %d &quot;</span>, taglen);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; taglen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, tag[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Save the symmetric key to secure storge */</span></div>
<div class="line">    <span class="comment">// secure_storage_write(key, keylen, &quot;sym_key&quot;);</span></div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Save the encrypted data to secure storge */</span></div>
<div class="line">    secure_storage_write(out, outlen, <span class="stringliteral">&quot;enc_data&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p ><b>Symmetric Key Decryption</b></p>
<p >TODO: Fails to match decrypted data. Example program to show how to use AES 256 GCM functions with ta-ref API.</p>
<p >Retrive the key from secure store and decrypt the data.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on data match, others if not</dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> symmetric_key_dec(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Data to compare with encrypted data  */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div>
<div class="line">        0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,</div>
<div class="line">        0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    <span class="keywordtype">size_t</span>  keylen = 256;</div>
<div class="line">    uint8_t out[ENCDATA_MAX];</div>
<div class="line">    <span class="keywordtype">size_t</span>  outlen = ENCDATA_MAX;</div>
<div class="line">    uint8_t iv[TAG_LEN];</div>
<div class="line">    uint8_t tag[TAG_LEN];</div>
<div class="line">    <span class="keywordtype">size_t</span>  taglen = TAG_LEN_BITS;</div>
<div class="line">    uint8_t *pdata = data;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">   </div>
<div class="line">    TEE_OperationHandle handle;</div>
<div class="line">    TEE_Result rv;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Read AES 256 KEY from secure storage */</span></div>
<div class="line">    <span class="comment">// secure_storage_read(key, &amp;keylen, &quot;sym_key&quot;);</span></div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Read encypted data from secure storage */</span></div>
<div class="line">    secure_storage_read(out, &amp;outlen, <span class="stringliteral">&quot;enc_data&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Reading Stored Data: size:%d &quot;</span>, outlen);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; outlen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, out[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Start decrypting test data. */</span></div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Specify for decrypting with AES 256 GCM */</span></div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_AES_GCM, TEE_MODE_DECRYPT, 256);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Set the key read from secure storage */</span></div>
<div class="line">    TEE_SetOperationKey(handle, key);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalant of EVP_DecryptInit_ex() in openssl  */</span></div>
<div class="line">    TEE_AEInit(handle, iv, <span class="keyword">sizeof</span>(iv), TAG_LEN_BITS, 0, 0);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalant of EVP_DecryptUpdate() in openssl.</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     * It passes only a chunk of data each time.</span></div>
<div class="line"><span class="comment">     * Typically it is used with moving to the next pointer in a for loop to</span></div>
<div class="line"><span class="comment">     * handle large data until the last chunk. Decrypting in</span></div>
<div class="line"><span class="comment">     * iteration makes it possible to handle large data, such as 4GB which is</span></div>
<div class="line"><span class="comment">     * not able to have entire data inside TEE memory size and/or only</span></div>
<div class="line"><span class="comment">     * partial data arrives through the Internet in streaming fashion. */</span></div>
<div class="line">    TEE_AEUpdateAAD(handle, pdata, CHUNK_SIZE);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Used combined with the TEE_AEUpdateAAD().</span></div>
<div class="line"><span class="comment">     * When the data is larger, move to next pointer of chunk in the data </span></div>
<div class="line"><span class="comment">     * for every iteration */</span></div>
<div class="line">    pdata += CHUNK_SIZE;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Equivalent in openssl is EVP_DecryptFinal() */</span> </div>
<div class="line">    TEE_AEDecryptFinal(handle, pdata, DATA_SIZE - CHUNK_SIZE, out, &amp;outlen, tag, &amp;taglen);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Closing TEE handle */</span></div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    TEE_FreeTransientObject(key);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Dump encrypted data and tag */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Decrypted Data: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; outlen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, out[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Actual Data: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; outlen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, data[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Check if the decrypted data is the same with the expected data  </span></div>
<div class="line"><span class="comment">     * to check the data integrity */</span></div>
<div class="line">    ret = memcmp(data, out, outlen);</div>
<div class="line">    <span class="keywordflow">if</span> (ret == 0) {</div>
<div class="line">        tee_printf(<span class="stringliteral">&quot;decrypt: Data matched!\n&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        tee_printf(<span class="stringliteral">&quot;decrypt: Data does not match!\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* returns 0 on success */</span></div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md26"></a>
Asymmetric Crypto Functions</h1>
<p ><b>Asymmetric Key Encryption</b></p>
<p >Example program to show how to use asymmetric key encryption functions with ECDSA_P256 on ta-ref API.</p>
<p >Generate a keypair and creating signature of a data and stores them. Check the return value of each API call on real product development.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> asymmetric_key_enc(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Start of Aysmmetric Encryption\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Data to encrypt as a example */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div>
<div class="line">        0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,</div>
<div class="line">        0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    uint8_t sig[SIG_LENGTH];</div>
<div class="line">    <span class="keywordtype">size_t</span>  siglen = SIG_LENGTH;</div>
<div class="line">    uint8_t *pdata = data;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hash[DATA_SIZE];</div>
<div class="line">    uint32_t hashlen = DATA_SIZE;</div>
<div class="line">   </div>
<div class="line">    TEE_ObjectHandle keypair;</div>
<div class="line">    TEE_OperationHandle handle;</div>
<div class="line">    TEE_Attribute attr;</div>
<div class="line">    TEE_Result rv;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Calculate hash of the test data first */</span></div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_SHA256, TEE_MODE_DIGEST, SHA_LENGTH);</div>
<div class="line">    TEE_DigestUpdate(handle, pdata, CHUNK_SIZE);</div>
<div class="line">    pdata += CHUNK_SIZE;</div>
<div class="line">    TEE_DigestDoFinal(handle, pdata, DATA_SIZE - CHUNK_SIZE, hash, &amp;hashlen);</div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Dump hash data */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;hash: size %d&quot;</span>, hashlen);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hashlen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, hash[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Generating Keypair with ECDSA_P256 */</span></div>
<div class="line">    TEE_AllocateTransientObject(TEE_TYPE_ECDSA_KEYPAIR, 256, &amp;keypair);</div>
<div class="line">    TEE_InitValueAttribute(&amp;attr, TEE_ATTR_ECC_CURVE, TEE_ECC_CURVE_NIST_P256,</div>
<div class="line">                           256);</div>
<div class="line">    TEE_GenerateKey(keypair, 256, &amp;attr, 1);</div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_ECDSA_P256, TEE_MODE_SIGN, 256);</div>
<div class="line">    TEE_SetOperationKey(handle, keypair);</div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Signing test data.</span></div>
<div class="line"><span class="comment">     * Keystone has ed25519_sign()</span></div>
<div class="line"><span class="comment">     * Equivalent in openssl is EVP_DigestSign() */</span></div>
<div class="line">    TEE_AsymmetricSignDigest(handle, NULL, 0, hash, hashlen, sig, &amp;siglen);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Closing TEE handle */</span></div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Dump encrypted data and tag */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Signature: size:%d &quot;</span>, siglen);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; siglen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, sig[i]);</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Save the asymmetric keypair to secure storge</span></div>
<div class="line"><span class="comment">     * TODO: would be better saving only pub key here */</span></div>
<div class="line">    secure_storage_write(keypair, 256 / 8, <span class="stringliteral">&quot;keypair&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Save the signature to secure storge */</span></div>
<div class="line">    secure_storage_write(sig, siglen, <span class="stringliteral">&quot;sig_data&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;End of Aysmmetric Encryption\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p ><b>Asymmetric Key Decryption</b></p>
<p >TODO: Fails to match decrypted data. Example program to show how to use asymmetric key Decryption functions with ECDSA_P256 on ta-ref API.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on successful decryption, others if not</dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> asymmetric_key_dec(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;Start of Aysmmetric Decryption\n&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Data to compare with encrypted data  */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,</div>
<div class="line">        0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,</div>
<div class="line">        0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    uint8_t sig[TAG_LEN];</div>
<div class="line">    <span class="keywordtype">size_t</span>  siglen = TAG_LEN_BITS;</div>
<div class="line">    uint8_t *pdata = data;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hash[DATA_SIZE];</div>
<div class="line">    uint32_t hashlen = DATA_SIZE;</div>
<div class="line">    <span class="keywordtype">size_t</span>  keypairlen = 256 / 8;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line">   </div>
<div class="line">    TEE_OperationHandle handle;</div>
<div class="line">    TEE_ObjectHandle key;</div>
<div class="line">    TEE_Result verify_ok;</div>
<div class="line">    TEE_ObjectHandle keypair;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Read pub key from secure storage */</span></div>
<div class="line">    <span class="comment">// secure_storage_read(keypair, &amp;keypairlen, &quot;keypair&quot;);</span></div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Read signature from secure storage */</span></div>
<div class="line">    <span class="comment">//secure_storage_read(sig, &amp;siglen, &quot;sig_data&quot;);</span></div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Calculate hash of the test data first */</span></div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_SHA256, TEE_MODE_DIGEST, SHA_LENGTH);</div>
<div class="line">    TEE_DigestUpdate(handle, pdata, CHUNK_SIZE);</div>
<div class="line">    pdata += CHUNK_SIZE;</div>
<div class="line">    TEE_DigestDoFinal(handle, pdata, DATA_SIZE - CHUNK_SIZE, hash, &amp;hashlen);</div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Dump hash data */</span></div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;hash: size %d&quot;</span>, hashlen);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hashlen; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, hash[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Set pub key */</span></div>
<div class="line">    TEE_AllocateOperation(&amp;handle, TEE_ALG_ECDSA_P256, TEE_MODE_VERIFY, 256);</div>
<div class="line">    TEE_SetOperationKey(handle, keypair);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Check data with the signature    </span></div>
<div class="line"><span class="comment">     * Keystone has ed25519_verify()</span></div>
<div class="line"><span class="comment">     * Equivalent in openssl is EVP_DigestVerify() */</span></div>
<div class="line">    verify_ok = TEE_AsymmetricVerifyDigest(handle, NULL, 0, hash, hashlen, sig, siglen);</div>
<div class="line">   </div>
<div class="line"><span class="comment">//    TEE_FreeTransientObject(keypair);</span></div>
<div class="line">    TEE_FreeOperation(handle);</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">if</span> (verify_ok == TEE_SUCCESS) {</div>
<div class="line">      tee_printf(<span class="stringliteral">&quot;verify ok\n&quot;</span>);</div>
<div class="line">      ret = 0;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      tee_printf(<span class="stringliteral">&quot;verify fails\n&quot;</span>);</div>
<div class="line">      ret = -1;</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;End of Aysmmetric Decryption\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* returns 0 on success */</span></div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md27"></a>
Open, Read, Write, Close On Secure Storage</h1>
<p ><b>Secure Storage Write</b></p>
<p >secure_storage_write() - Example program to show how to use secure storage with ta-ref API. Write the data to secure storage.</p>
<p >The secure storage is for storing cryptographic keys, certificates, security sensitive data such as personalization data. How the secure storage is secure is implementation dependent. Ideally the secure storage is provided separately from REE accessible areas and can not be tampered from User Application on REE, read, write, delete nore retrievable the file name. Typically requires hardware support, and if not then some easy implementation might be just saving the data on a filesystem on Linux residing in REE which does not provide the secure level as mentioned here. The data are saved with different encryption keys from other TAs, and not able to read the same data by other TAs.</p>
<p >TODO: Relax the limitation of the size constraint. The size is limited to multiple of 16 bytes at the moment.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> secure_storage_write(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Data to write to secure storage */</span></div>
<div class="line">    uint8_t data[DATA_SIZE] = {</div>
<div class="line">        0xff, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* For opening secure storage */</span></div>
<div class="line">    TEE_ObjectHandle object;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Create a file in secure storage */</span></div>
<div class="line">    TEE_CreatePersistentObject(TEE_STORAGE_PRIVATE,</div>
<div class="line">                                    <span class="stringliteral">&quot;filename&quot;</span>, strlen(<span class="stringliteral">&quot;filename&quot;</span>),</div>
<div class="line">                                    (TEE_DATA_FLAG_ACCESS_WRITE</div>
<div class="line">                                     | TEE_DATA_FLAG_OVERWRITE),</div>
<div class="line">                                    TEE_HANDLE_NULL,</div>
<div class="line">                                    NULL, 0,</div>
<div class="line">                                    &amp;<span class="keywordtype">object</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Write the data  */</span></div>
<div class="line">    TEE_WriteObjectData(<span class="keywordtype">object</span>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)data, DATA_SIZE);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Close secure storage */</span></div>
<div class="line">    TEE_CloseObject(<span class="keywordtype">object</span>);</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><p ><b>Secure Storage Read</b></p>
<p >secure_storage_read() - Example program to show how to use secure storage with ta-ref API. Read the data from secure storage.</p>
<p >Read the data from the secure storage and compare with expected data.</p>
<dl class="section return"><dt>Returns</dt><dd>TEE_SUCCESS if the data mached, others if not.</dd></dl>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> secure_storage_read(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Data to compare with written data in secure storage */</span></div>
<div class="line">    uint8_t cmp_data[DATA_SIZE] = {</div>
<div class="line">        0xff, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,</div>
<div class="line">        0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f</div>
<div class="line">    };</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Stores read data */</span></div>
<div class="line">    uint8_t buf[DATA_SIZE * 2];</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* For opening secure storage */</span></div>
<div class="line">    TEE_ObjectHandle object;</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Open a file in secure storage */</span></div>
<div class="line">    TEE_OpenPersistentObject(TEE_STORAGE_PRIVATE,</div>
<div class="line">                                  <span class="stringliteral">&quot;filename&quot;</span>, strlen(<span class="stringliteral">&quot;filename&quot;</span>),</div>
<div class="line">                                  TEE_DATA_FLAG_ACCESS_READ,</div>
<div class="line">                                  &amp;<span class="keywordtype">object</span>);</div>
<div class="line">   </div>
<div class="line">    uint32_t count;</div>
<div class="line">    <span class="comment">/* Read */</span></div>
<div class="line">    TEE_ReadObjectData(<span class="keywordtype">object</span>, (<span class="keywordtype">char</span> *)buf, DATA_SIZE, &amp;count);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Close secure storage */</span></div>
<div class="line">    TEE_CloseObject(<span class="keywordtype">object</span>);</div>
<div class="line">   </div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;%d bytes read: &quot;</span>, count);</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; count; i++) {</div>
<div class="line">      tee_printf (<span class="stringliteral">&quot;%02x&quot;</span>, buf[i]);</div>
<div class="line">    }</div>
<div class="line">    tee_printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">   </div>
<div class="line">    <span class="comment">/* Compare read data with written data */</span></div>
<div class="line">    <span class="keywordtype">int</span> verify_ok;</div>
<div class="line">    verify_ok = !memcmp(buf, cmp_data, count);</div>
<div class="line">    <span class="keywordflow">if</span> (verify_ok) {</div>
<div class="line">        tee_printf(<span class="stringliteral">&quot;verify ok\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> TEE_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        tee_printf(<span class="stringliteral">&quot;verify fails\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">return</span> TEE_SUCCESS;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md28"></a>
API Error Codes and its values</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">API ERROR CODE   </th><th class="markdownTableHeadNone">VALUE    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_SUCCESS   </td><td class="markdownTableBodyNone">0x00000000    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_CORRUPT_OBJECT   </td><td class="markdownTableBodyNone">0xF0100001    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_CORRUPT_OBJECT_2   </td><td class="markdownTableBodyNone">0xF0100002    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_STORAGE_NOT_AVAILABLE   </td><td class="markdownTableBodyNone">0xF0100003    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_STORAGE_NOT_AVAILABLE_2   </td><td class="markdownTableBodyNone">0xF0100004    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_GENERIC   </td><td class="markdownTableBodyNone">0xFFFF0000    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_ACCESS_DENIED   </td><td class="markdownTableBodyNone">0xFFFF0001    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_CANCEL   </td><td class="markdownTableBodyNone">0xFFFF0002    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_ACCESS_CONFLICT   </td><td class="markdownTableBodyNone">0xFFFF0003    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_EXCESS_DATA   </td><td class="markdownTableBodyNone">0xFFFF0004    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_BAD_FORMAT   </td><td class="markdownTableBodyNone">0xFFFF0005    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_BAD_PARAMETERS   </td><td class="markdownTableBodyNone">0xFFFF0006    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_BAD_STATE   </td><td class="markdownTableBodyNone">0xFFFF0007    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_ITEM_NOT_FOUND   </td><td class="markdownTableBodyNone">0xFFFF0008    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_NOT_IMPLEMENTED   </td><td class="markdownTableBodyNone">0xFFFF0009    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_NOT_SUPPORTED   </td><td class="markdownTableBodyNone">0xFFFF000A    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_NO_DATA   </td><td class="markdownTableBodyNone">0xFFFF000B    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_OUT_OF_MEMORY   </td><td class="markdownTableBodyNone">0xFFFF000C    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_BUSY   </td><td class="markdownTableBodyNone">0xFFFF000D    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_COMMUNICATION   </td><td class="markdownTableBodyNone">0xFFFF000E    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_SECURITY   </td><td class="markdownTableBodyNone">0xFFFF000F    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_SHORT_BUFFER   </td><td class="markdownTableBodyNone">0xFFFF0010    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_EXTERNAL_CANCEL   </td><td class="markdownTableBodyNone">0xFFFF0011    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_OVERFLOW   </td><td class="markdownTableBodyNone">0xFFFF300F    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_TARGET_DEAD   </td><td class="markdownTableBodyNone">0xFFFF3024    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_STORAGE_NO_SPACE   </td><td class="markdownTableBodyNone">0xFFFF3041    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_MAC_INVALID   </td><td class="markdownTableBodyNone">0xFFFF3071    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TEE_ERROR_SIGNATURE_INVALID   </td><td class="markdownTableBodyNone">0xFFFF3072    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TEE_ERROR_TIME_NOT_SET   </td><td class="markdownTableBodyNone">0xFFFF5000   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
